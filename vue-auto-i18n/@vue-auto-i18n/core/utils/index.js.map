{"version":3,"sources":["../../src/utils/index.ts"],"sourcesContent":["/**\r\n * Utility Functions\r\n */\r\n\r\nimport { promises as fs } from 'fs'\r\nimport path from 'path'\r\n\r\n/**\r\n * Ensure directory exists\r\n */\r\nexport async function ensureDir(dir: string): Promise<void> {\r\n  try {\r\n    await fs.access(dir)\r\n  } catch {\r\n    await fs.mkdir(dir, { recursive: true })\r\n  }\r\n}\r\n\r\n/**\r\n * Save extracted text to cache file\r\n */\r\nexport async function saveExtractedText(result: any, config: any = {}): Promise<string> {\r\n  const cacheDir = config.cacheDir || '.i18n-cache'\r\n  await ensureDir(cacheDir)\r\n\r\n  const filePath = path.join(cacheDir, 'extracted.json')\r\n  await fs.writeFile(filePath, JSON.stringify(result, null, 2), 'utf-8')\r\n\r\n  return filePath\r\n}\r\n\r\n/**\r\n * Load extracted text from cache\r\n */\r\nexport async function loadExtractedText(config: any = {}): Promise<any> {\r\n  const cacheDir = config.cacheDir || '.i18n-cache'\r\n  const filePath = path.join(cacheDir, 'extracted.json')\r\n\r\n  try {\r\n    await fs.access(filePath)\r\n  } catch {\r\n    throw new Error('Please run extract command first to extract text')\r\n  }\r\n\r\n  const content = await fs.readFile(filePath, 'utf-8')\r\n  return JSON.parse(content)\r\n}\r\n\r\n/**\r\n * Save locale file\r\n */\r\nexport async function saveLocale(lang: string, data: any, config: any = {}): Promise<string> {\r\n  const dir = config.localesDir || 'src/locales'\r\n  await ensureDir(dir)\r\n\r\n  const filePath = path.join(dir, `${lang}.json`)\r\n  await fs.writeFile(filePath, JSON.stringify(data, null, 2), 'utf-8')\r\n\r\n  return filePath\r\n}\r\n\r\n/**\r\n * Load locale file\r\n */\r\nexport async function loadLocale(lang: string, config: any = {}): Promise<any> {\r\n  const localesDir = config.localesDir || 'src/locales'\r\n  const filePath = path.join(localesDir, `${lang}.json`)\r\n\r\n  try {\r\n    await fs.access(filePath)\r\n  } catch {\r\n    return {}\r\n  }\r\n\r\n  const content = await fs.readFile(filePath, 'utf-8')\r\n  return JSON.parse(content)\r\n}\r\n\r\n/**\r\n * Generate unique key for text\r\n */\r\nexport function generateKey(text: string, index: number): string {\r\n  // If text is short and doesn't contain special characters, use text as key\r\n  if (text.length <= 20 && /^[\\u4e00-\\u9fa5a-zA-Z0-9]+$/.test(text)) {\r\n    return text\r\n  }\r\n\r\n  // Otherwise use auto-generated key\r\n  return `text_${index}`\r\n}\r\n\r\n/**\r\n * Check if string contains Chinese characters\r\n */\r\nexport function hasChinese(text: string): boolean {\r\n  return /[\\u4e00-\\u9fa5]/.test(text)\r\n}\r\n\r\n/**\r\n * Normalize whitespace in text\r\n */\r\nexport function normalizeText(text: string): string {\r\n  return text.trim().replace(/\\s+/g, ' ')\r\n}\r\n\r\n/**\r\n * Read file with encoding\r\n */\r\nexport async function readFile(filePath: string, encoding: BufferEncoding = 'utf-8'): Promise<string> {\r\n  return await fs.readFile(filePath, encoding)\r\n}\r\n\r\n/**\r\n * Write file with encoding\r\n */\r\nexport async function writeFile(filePath: string, content: string, encoding: BufferEncoding = 'utf-8'): Promise<void> {\r\n  await ensureDir(path.dirname(filePath))\r\n  await fs.writeFile(filePath, content, encoding)\r\n}\r\n\r\n/**\r\n * Check if file exists\r\n */\r\nexport async function fileExists(filePath: string): Promise<boolean> {\r\n  try {\r\n    await fs.access(filePath)\r\n    return true\r\n  } catch {\r\n    return false\r\n  }\r\n}\r\n"],"mappings":";AAIA,SAAS,YAAY,UAAU;AAC/B,OAAO,UAAU;AAKjB,eAAsB,UAAU,KAA4B;AAC1D,MAAI;AACF,UAAM,GAAG,OAAO,GAAG;AAAA,EACrB,QAAQ;AACN,UAAM,GAAG,MAAM,KAAK,EAAE,WAAW,KAAK,CAAC;AAAA,EACzC;AACF;AAKA,eAAsB,kBAAkB,QAAa,SAAc,CAAC,GAAoB;AACtF,QAAM,WAAW,OAAO,YAAY;AACpC,QAAM,UAAU,QAAQ;AAExB,QAAM,WAAW,KAAK,KAAK,UAAU,gBAAgB;AACrD,QAAM,GAAG,UAAU,UAAU,KAAK,UAAU,QAAQ,MAAM,CAAC,GAAG,OAAO;AAErE,SAAO;AACT;AAKA,eAAsB,kBAAkB,SAAc,CAAC,GAAiB;AACtE,QAAM,WAAW,OAAO,YAAY;AACpC,QAAM,WAAW,KAAK,KAAK,UAAU,gBAAgB;AAErD,MAAI;AACF,UAAM,GAAG,OAAO,QAAQ;AAAA,EAC1B,QAAQ;AACN,UAAM,IAAI,MAAM,kDAAkD;AAAA,EACpE;AAEA,QAAM,UAAU,MAAM,GAAG,SAAS,UAAU,OAAO;AACnD,SAAO,KAAK,MAAM,OAAO;AAC3B;AAKA,eAAsB,WAAW,MAAc,MAAW,SAAc,CAAC,GAAoB;AAC3F,QAAM,MAAM,OAAO,cAAc;AACjC,QAAM,UAAU,GAAG;AAEnB,QAAM,WAAW,KAAK,KAAK,KAAK,GAAG,IAAI,OAAO;AAC9C,QAAM,GAAG,UAAU,UAAU,KAAK,UAAU,MAAM,MAAM,CAAC,GAAG,OAAO;AAEnE,SAAO;AACT;AAKA,eAAsB,WAAW,MAAc,SAAc,CAAC,GAAiB;AAC7E,QAAM,aAAa,OAAO,cAAc;AACxC,QAAM,WAAW,KAAK,KAAK,YAAY,GAAG,IAAI,OAAO;AAErD,MAAI;AACF,UAAM,GAAG,OAAO,QAAQ;AAAA,EAC1B,QAAQ;AACN,WAAO,CAAC;AAAA,EACV;AAEA,QAAM,UAAU,MAAM,GAAG,SAAS,UAAU,OAAO;AACnD,SAAO,KAAK,MAAM,OAAO;AAC3B;AAKO,SAAS,YAAY,MAAc,OAAuB;AAE/D,MAAI,KAAK,UAAU,MAAM,8BAA8B,KAAK,IAAI,GAAG;AACjE,WAAO;AAAA,EACT;AAGA,SAAO,QAAQ,KAAK;AACtB;AAKO,SAAS,WAAW,MAAuB;AAChD,SAAO,kBAAkB,KAAK,IAAI;AACpC;AAKO,SAAS,cAAc,MAAsB;AAClD,SAAO,KAAK,KAAK,EAAE,QAAQ,QAAQ,GAAG;AACxC;AAKA,eAAsB,SAAS,UAAkB,WAA2B,SAA0B;AACpG,SAAO,MAAM,GAAG,SAAS,UAAU,QAAQ;AAC7C;AAKA,eAAsB,UAAU,UAAkB,SAAiB,WAA2B,SAAwB;AACpH,QAAM,UAAU,KAAK,QAAQ,QAAQ,CAAC;AACtC,QAAM,GAAG,UAAU,UAAU,SAAS,QAAQ;AAChD;AAKA,eAAsB,WAAW,UAAoC;AACnE,MAAI;AACF,UAAM,GAAG,OAAO,QAAQ;AACxB,WAAO;AAAA,EACT,QAAQ;AACN,WAAO;AAAA,EACT;AACF;","names":[]}